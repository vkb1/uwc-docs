

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5.0 Container Configuration setting &mdash;   documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.0 Site Configurations" href="page_06.html" />
    <link rel="prev" title="4.0 Container Configuration setting" href="page_04.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> 
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="First_pg.html">Legal Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_01.html">1.0  Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_01.html#purpose">1.1  Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_01.html#scope">1.2  Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_01.html#system-requirements">1.3  System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_02.html">2.0  Before Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#uwc-for-o-g-site">2.1  UWC for O&amp;G Site</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#upstream-oil-and-gas-facilities">2.2  Upstream Oil and Gas Facilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_02.html#understanding-uwc-platform">2.3  Understanding UWC Platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_02.html#modbus-containers">2.3.1  Modbus containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_02.html#mqtt-bridge-container">2.3.2   MQTT-Bridge container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_02.html#sparkplug-bridge-container">2.3.3  Sparkplug-Bridge container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_02.html#kpi-application-container">2.3.4  KPI Application Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_02.html#configurations">2.3.5  Configurations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_03.html">3.0  Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_03.html#how-to-install-uwc-software-with-eii-installer">3.1  How to install UWC software with EII installer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_04.html">4.0  Container Configuration setting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_04.html#deactivate-unattended-upgrades">4.1.1   Deactivate Unattended Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_04.html#deactivate-periodic-unattended-upgrades">4.1.2   Deactivate Periodic Unattended Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_04.html#deactivate-scheduled-upgrades">4.1.3   Deactivate Scheduled Upgrades</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5.0  Container Configuration setting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#containers">5.1  Containers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-configuration-for-modbus-client-containers">5.1.1  Common Configuration for Modbus Client Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-foodbus-network">5.1.2  Configuration foodbus network</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modbus-tcp-communication">5.2             Modbus TCP Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modbus-rtu-communication">5.3         Modbus RTU Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mqtt-bridge">5.4     MQTT Bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mqtt">5.5     MQTT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#accessing-secured-mqtt-container-from-an-external-mqtt-client">5.5.1   Accessing secured MQTT container from an external MQTT client</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-secured-mqtt-container-from-a-client-inside-a-container">5.5.2   Accessing secured MQTT container from a client inside a container</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sparkplug-bridge">5.6     Sparkplug-Bridge</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-requisite-for-running-sparkplug-bridge">5.6.1   Pre-requisite for running Sparkplug-Bridge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#kpi-app">5.7     KPI App</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_06.html">6.0  Site Configurations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#system-level-global-configuration">6.1     System Level Global Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#settings-for-polling-and-on-demand-operation">6.1.1   Settings for Polling and On-Demand operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#settings-for-sparkplug-bridge-sparkplug-communication-operation">6.1.2   Settings for Sparkplug-Bridge – SparkPlug communication operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#settings-for-default-scale-factor">6.1.3   Settings for default scale factor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#how-to-configure-site-and-wellhead">6.2     How to Configure Site and Wellhead</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#configuring-tcp-device-in-device-group">6.2.1   Configuring TCP device in device-group</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_06.html#configuring-rtu-device-in-device-group">6.2.2   Configuring RTU device in device-group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#how-to-configure-devices">6.3     How to Configure Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#how-to-configure-device-points">6.4     How to Configure Device points</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#how-to-add-edit-delete-new-wellhead-device-point-configurations">6.5     How to add/edit/delete new wellhead/device/point configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_06.html#kpi-app-configuration">6.6     KPI App Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_07.html">7.0     UWC Modbus Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#data-polling">7.1     Data Polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#on-demand-write">7.2     On-Demand Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#on-demand-read">7.3     On-Demand Read</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_07.html#kpi-application">7.4     KPI Application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_08.html">8.0     Sparkplug-Bridge Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_08.html#app-virtual-device-communication">8.1     App (virtual device) communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#app-message-topic-format">8.1.1   App Message Topic Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#app-message-birth">8.1.2   App Message - BIRTH</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#app-message-data">8.1.3   App Message - DATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#app-message-cmd">8.1.4   App Message - CMD</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#app-message-death">8.1.5   App Message - DEATH</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#app-message-templatedef">8.1.6   App Message - TemplateDef</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#start-birth-process">8.1.7   START_BIRTH_PROCESS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_08.html#modbus-real-device-communication">8.2     Modbus (real) device communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#support-for-dbirth">8.2.1   Support for DBIRTH</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#support-for-ddata">8.2.2   Support for DDATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#support-for-dcmd">8.2.3   Support for DCMD</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#support-for-ddeath">8.2.4   Support for DDEATH</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_08.html#sparkplug-messages">8.3     SparkPlug Messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#nbirth-message">8.3.1   NBIRTH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#ndeath-message">8.3.2   NDEATH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#dbirth-message">8.3.3   DBIRTH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#ddeath-message">8.3.4   DDEATH Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#ddata-message">8.3.5   DDATA Message</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_08.html#ncmd-message">8.3.6   NCMD Message</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_09.html">9.0     Debugging steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_10.html">10.0    Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_11.html">11.0    Steps to flash LFM BIOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_12.html">12.0    UWC Gateway to Cloud Communication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_12.html#architecture">12.1    Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_12.html#installation-and-configuration">12.2    Installation and Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="page_12.html#ssb-installation-and-cloud-infrastructure-provisioning">12.2.1  SSB installation and cloud infrastructure provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_12.html#aws-iot-core-broker-and-ssb-configuration">12.2.2  AWS IoT core broker and SSB configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_12.html#uwc-gateway-configuration">12.2.3  UWC gateway configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_12.html#monitor-data-on-cloud">12.3    Monitor Data on Cloud</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_13.html">13.0    Steps to Apply RT Patch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#install-prerequisites">13.1    Install prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#keyboard-shortcuts-for-menuconfig-ui">13.2    Keyboard shortcuts for menuconfig UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#steps-to-apply-preempt-rt-patch">13.3    Steps to apply PREEMPT_RT patch</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_13.html#references">13.4    References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_14.html">14.0 Appendix</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html"></a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>5.0  Container Configuration setting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com//vkb1/uwc-docs/blob/main/source/Pages/page_05.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="container-configuration-setting">
<h1>5.0  Container Configuration setting<a class="headerlink" href="#container-configuration-setting" title="Permalink to this headline">¶</a></h1>
<p>This section provides details about configuring UWC containers.</p>
<section id="containers">
<h2>5.1  Containers<a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Following containers are developed under UWC:</dt><dd><ul class="simple">
<li><p>Modbus TCP Master</p></li>
<li><p>Modbus RTU Master</p></li>
<li><p>MQTT-Bridge</p></li>
<li><p>MQTT</p></li>
<li><p>Sparkplug-Bridge</p></li>
<li><p>KPI Application</p></li>
</ul>
</dd>
</dl>
<p>For configuring these containers, docker-compose.yml file is used. The docker-compose.yml is auto generated based on inputs provided while executing script 02_provision_UWC.sh..</p>
<p>For more details, please refer README provided in EII documentation.</p>
<p>Path for README – <a class="reference external" href="https://github.com/open-edge-insights/eii-core/blob/master/README.md">https://github.com/open-edge-insights/eii-core/blob/master/README.md</a></p>
<p>UWC containers (i.e., Modbus Clients and MQTT-Bridge) use ZeroMQ to communicate with each other.</p>
<p>At present, recommendation is to have only one Modbus-TCP and one Modbus-RTU container. Hence, changes to configuration present in docker-compose.yml file shall not be needed.</p>
<section id="common-configuration-for-modbus-client-containers">
<h3>5.1.1  Common Configuration for Modbus Client Containers<a class="headerlink" href="#common-configuration-for-modbus-client-containers" title="Permalink to this headline">¶</a></h3>
<p>Following are configurations, applicable for Modbus Client (TCP and RTU both) containers:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/table3.png"><img alt="../_images/table3.png" src="../_images/table3.png" style="width: 630.4000000000001px; height: 375.20000000000005px;" /></a>
</figure>
<dl>
<dt>Example for Modbus-TCP-Master container from docker-compose.yml file:</dt><dd><p>AppName: “TCP”</p>
<p>ETCD_HOST: ${ETCD_HOST}</p>
<p>ETCD_CLIENT_PORT: ${ETCD_CLIENT_PORT}</p>
<p>ETCD_PREFIX: ${ETCD_PREFIX}</p>
<p>DEV_MODE: ${DEV_MODE}</p>
<p>no_proxy: ${eii_no_proxy}</p>
<p>Log4cppPropsFile: “/opt/intel/config/log4cpp.properties”</p>
<p>MY_APP_ID: 1</p>
<p>CUTOFF_INTERVAL_PERCENTAGE: 90</p>
<p>CertType: “zmq”</p>
<p>PROFILING_MODE: ${PROFILING_MODE}</p>
<p>NETWORK_TYPE: TCP</p>
<p>DEVICES_GROUP_LIST_FILE_NAME: “Devices_group_list.yml”</p>
</dd>
</dl>
</section>
<section id="configuration-foodbus-network">
<h3>5.1.2  Configuration foodbus network<a class="headerlink" href="#configuration-foodbus-network" title="Permalink to this headline">¶</a></h3>
<p>A separate network configuration YML file is maintained for each network. E.g., If there are 2 RTU and 1 TCP networks, then there will be 3 network configuration files. This file contains following configuration for both TCP and RTU:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>inter-frame delay and response timeout values are in Millisecond.</p>
</div>
<p>interframe_delay: 1</p>
<p>response_timeout: 80</p>
<dl>
<dt>For Modbus RTU master, following additional configurations are needed apart from above mentioned parameters:</dt><dd><p>baudrate: 9600</p>
<p>parity: “N”</p>
<p>com_port_name: “/dev/ttyS0”</p>
</dd>
</dl>
<figure class="align-center">
<a class="reference internal image-reference" href="Pages/Doc_Images/table4.png"><img alt="Pages/Doc_Images/table4.png" src="Pages/Doc_Images/table4.png" /></a>
</figure>
</section>
</section>
<section id="modbus-tcp-communication">
<h2>5.2             Modbus TCP Communication<a class="headerlink" href="#modbus-tcp-communication" title="Permalink to this headline">¶</a></h2>
<p>When used in TCP mode, the publisher of a stream will bind to a TCP socket and the subscribers connect to it to receive data. In Request-Response pattern, the responder acts as the server and binds the socket and the requester connects to it.</p>
</section>
<section id="modbus-rtu-communication">
<h2>5.3         Modbus RTU Communication<a class="headerlink" href="#modbus-rtu-communication" title="Permalink to this headline">¶</a></h2>
<p>Modbus RTU is an open serial protocol derived from the Master/Slave architecture. UWC Modbus-rtu-container is used as master and slave can be configured.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/flow1.png"><img alt="../_images/flow1.png" src="../_images/flow1.png" style="width: 399.59999999999997px; height: 363.59999999999997px;" /></a>
<figcaption>
<p><span class="caption-text">parameters (i.e., baud rate, parity, stop bits) from docker-compose.yml file.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="mqtt-bridge">
<h2>5.4     MQTT Bridge<a class="headerlink" href="#mqtt-bridge" title="Permalink to this headline">¶</a></h2>
<p>This container is used to send messages from ZeroMQ to MQTT and vice-versa.</p>
<p>Modbus containers communicate over the internal Edge Insights for Industrial data bus (ZMQ). The MQTT-Bridge module enables communication with Modbus containers using MQTT. The MQTT- Bridge module reads data on ZMQ received from Modbus containers and publishes that data on MQTT. Similarly, the MQTT- Bridge module reads data from MQTT and publishes it on ZMQ.</p>
</section>
<section id="mqtt">
<h2>5.5     MQTT<a class="headerlink" href="#mqtt" title="Permalink to this headline">¶</a></h2>
<p>The MQTT container is a mosquitto broker required for MQTT to publish/subscribe data. MQTT broker use port “11883”.</p>
<p>MQTT clients should use above mentioned port for communication.</p>
<section id="accessing-secured-mqtt-container-from-an-external-mqtt-client">
<h3>5.5.1   Accessing secured MQTT container from an external MQTT client<a class="headerlink" href="#accessing-secured-mqtt-container-from-an-external-mqtt-client" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt><strong>Pre-requisites:</strong></dt><dd><p>All UWC containers must be deployed-on gateway with DEV_MODE=false (i.e., secured mode).</p>
</dd>
</dl>
<p><strong>Steps to follow:</strong></p>
<blockquote>
<div><ol class="arabic">
<li><p>Open a terminal and execute following command to create local directory to keep certificates of MQTT broker,
<em>mkdir ~/mqtt_certs &amp;&amp; cd ~/mqtt_certs</em></p>
<p>Copy ca/ and /mymqttcerts directories in local directory i.e., created in  script <em>02_provision_UWC.sh</em> from
<em>working_dir/IEdgeInsights/build/provision/Certificates/ directory</em>.</p>
<p>Command to copy ca/ and /mymqttcerts/ dir in local dir (i.e., mqtt_certs)</p>
<p><em>sudo cp -r /&lt;working_dir&gt;/IEdgeInsights/build/provision/Certificates/ca ~/mqtt_certs/</em></p>
</li>
<li><p>Assign read permission to local certs using following command,
sudo chown -R $USER:$USER  &amp;&amp; sudo chmod +r ca/* mymqttcerts/*</p>
<p><strong>Please Note:</strong> Read permissions are only required for ca/ and /mymqttcerts directories present inside mqtt_certs directory copied in step2.</p>
<p>Provide right access to certificates directory using below command – sudo chmod +x Certificates in</p>
<p><em>&lt;working_dir&gt;/IEdgeInsights/build/provision/Certificates</em></p>
</li>
<li><p>Open MQTT client e.g., MQTT.fx</p></li>
<li><p>Open the connection setting and click on SSL/TLS tab.</p>
<p>&gt;&gt; then click on Self Signed certificate option &gt;&gt; select CA file from <em>mqtt_certs/ca</em>  directory (file name : ca_certificate.pem) , Client Certificate file from <em>mqtt_certs/mymqttcerts</em> directory (File name : mymqttcerts_client_certificate.pem) and Client key File from  <em>mqtt_certs/mymqttcerts</em>  directory (File name : mymqttcerts_client_key.pem) copied in step 2</p>
</li>
<li><p>Click on PEM Formatted check box and then save the setting and then connect. Refer below screenshot for more details</p></li>
</ol>
</div></blockquote>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/image4.png"><img alt="../_images/image4.png" src="../_images/image4.png" style="width: 499.09999999999997px; height: 280.7px;" /></a>
<figcaption>
<p><span class="caption-text">Figure. 4.5.1: Screen capture for mqtt.fx client connection</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="accessing-secured-mqtt-container-from-a-client-inside-a-container">
<h3>5.5.2   Accessing secured MQTT container from a client inside a container<a class="headerlink" href="#accessing-secured-mqtt-container-from-a-client-inside-a-container" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Mention following secrets for a new container in docker-compose.yml file.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>ca_broker – CA certificate</p></li>
<li><p>client_cert – Client certificate</p></li>
<li><p>client_key – Client Key</p></li>
</ul>
</div></blockquote>
<p>Following sample snippet for docker-compose.yml file</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image5.png"><img alt="../_images/image5.png" src="../_images/image5.png" style="width: 274.5px; height: 111.60000000000001px;" /></a>
</figure>
<ol class="arabic simple" start="2">
<li><p>Use certificates mentioned in step 1 inside application to connect with secured MQTT broker which is running as a part of UWC.</p></li>
</ol>
<p>Following is the sample code snippet in C++ to use certificates in a program,</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image6.png"><img alt="../_images/image6.png" src="../_images/image6.png" style="width: 463.2px; height: 100.2px;" /></a>
</figure>
<ol class="arabic simple" start="3">
<li><p>Deploy containers using usual deployment process.</p></li>
</ol>
</section>
</section>
<section id="sparkplug-bridge">
<h2>5.6     Sparkplug-Bridge<a class="headerlink" href="#sparkplug-bridge" title="Permalink to this headline">¶</a></h2>
<p>This container implements Eclipse Foundation’s SparkPlug standard to expose data to compliant SCADA Master over MQTT.</p>
<section id="pre-requisite-for-running-sparkplug-bridge">
<h3>5.6.1   Pre-requisite for running Sparkplug-Bridge<a class="headerlink" href="#pre-requisite-for-running-sparkplug-bridge" title="Permalink to this headline">¶</a></h3>
<ol class="loweralpha simple">
<li><p>SCADA Master (e.g., Ignition System) shall be installed and configured.</p></li>
<li><p>MQTT broker shall be installed and configured in SCADA Master. At present secured connectivity for MQTT is not supported.</p></li>
<li><p>Following parameters should be configured for Sparkplug-Bridge in docker-compose.yml file:</p></li>
</ol>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/table5.png"><img alt="../_images/table5.png" src="../_images/table5.png" style="width: 469.7px; height: 63.699999999999996px;" /></a>
</figure>
</section>
</section>
<section id="kpi-app">
<h2>5.7     KPI App<a class="headerlink" href="#kpi-app" title="Permalink to this headline">¶</a></h2>
<p>This is a sample application which implements control loops and logs data in a log file named “AnalysisKPIApp.log”. Normally 3 log files are created on rolling basis i.e., once tie set file size limit is exceeded, a new file is created and likewise max 3 files are created. After this, the log files are overwritten.</p>
<p>The log file size can be updated, if required.</p>
<p>File: log4cpp.properties</p>
<p>Path in release package: kpi-tactic/KPIApp/Config</p>
<p>Path after deployment inside container: /opt/intel/config/log4cpp.properties</p>
<p>Log files created are - AnalysisKPIApp.log, AnalysisKpiApp.log1, and AnalysisKpiApp.log2. These files are created in .txt format. Latest data will be available in AnalysisKPIApp.log followed by AnalysisKpiApp.log1, and AnalysisKpiApp.log2</p>
<p>Default log file size is around 34mb.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image7.png"><img alt="../_images/image7.png" src="../_images/image7.png" style="width: 544.0px; height: 42.0px;" /></a>
</figure>
<p>To change the file size, “log4cpp.properties” needs to be changed. Please change the limit highlighted above. The max file size mentioned here is in bytes. Please identify number of bytes as per file size needed and set the value here.</p>
<p>Please run script 03 Build_Run_UWC.sh   after changing “log4cpp.properties”.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="page_06.html" class="btn btn-neutral float-right" title="6.0 Site Configurations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="page_04.html" class="btn btn-neutral float-left" title="4.0 Container Configuration setting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, APP.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>