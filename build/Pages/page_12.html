

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>12.0 UWC Gateway to Cloud Communication &mdash;   documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="13.0 Steps to Apply RT Patch" href="page_13.html" />
    <link rel="prev" title="11.0 Steps to flash LFM BIOS" href="page_11.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> 
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="First_pg.html">Legal Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_01.html">1.0  Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_02.html">2.0  Before Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_03.html">3.0  Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_04.html">4.0  Container Configuration setting</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_05.html">5.0  Container Configuration setting</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_06.html">6.0  Site Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_07.html">7.0     UWC Modbus Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_08.html">8.0     Sparkplug-Bridge Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_09.html">9.0     Debugging steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_10.html">10.0    Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_11.html">11.0    Steps to flash LFM BIOS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">12.0    UWC Gateway to Cloud Communication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#architecture">12.1    Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-and-configuration">12.2    Installation and Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ssb-installation-and-cloud-infrastructure-provisioning">12.2.1  SSB installation and cloud infrastructure provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aws-iot-core-broker-and-ssb-configuration">12.2.2  AWS IoT core broker and SSB configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uwc-gateway-configuration">12.2.3  UWC gateway configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#monitor-data-on-cloud">12.3    Monitor Data on Cloud</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_13.html">13.0    Steps to Apply RT Patch</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_14.html">14.0 Appendix</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html"></a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>12.0    UWC Gateway to Cloud Communication</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/Pages/page_12.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="uwc-gateway-to-cloud-communication">
<h1>12.0    UWC Gateway to Cloud Communication<a class="headerlink" href="#uwc-gateway-to-cloud-communication" title="Permalink to this headline">¶</a></h1>
<p>Below steps describe UWC Gateway and cloud communication architecture and steps to connect UWC Gateway to AWS Sitewise.</p>
<section id="architecture">
<h2>12.1    Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<p>Modbus devices connects to the on-prem UWC gateway. The gateway is having Sparkplug MQTT client which securely publishes Sparkplug format data to AWS IoT Core. AWS IoT Core service provisions cloud connectivity to IoT edge devices. AWS IoT Core possesses an MQTT broker as one of its components. With this connectivity, UWC gateway published data is available in the AWS cloud. Please find more information about AWS IoT Core at <a class="reference external" href="https://aws.amazon.com/iot-core">https://aws.amazon.com/iot-core</a>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image_update_12.png"><img alt="../_images/image_update_12.png" src="../_images/image_update_12.png" style="width: 566.1px; height: 383.40000000000003px;" /></a>
</figure>
<p>Sparkplug Sitewise Bridge (SSB) is a service which rapidly connects operational technology (OT) data from Industrial Operations (on-prem data) to AWS IoT Sitewise with minimal configuration and zero coding. Please find more information on SSB at <a class="reference external" href="https://aws.amazon.com/marketplace/pp/Cirrus-Link-Sparkplug-SiteWise-Bridge/B08L8KNCNN">https://aws.amazon.com/marketplace/pp/Cirrus-Link-Sparkplug-SiteWise-Bridge/B08L8KNCNN</a>.</p>
<p>SSB software runs in an EC2 instance which is running in AWS cloud. SSB software comprises MQTT client which subscribes to the AWS IoT Core broker to receive UWC gateway data. When SSB receives UWC gateway data it creates and update resources (Assests, Models) in AWS Sitewise. In AWS Sitewise, user can monitor UWC gateway data. Please find more information about Sitewise at <a class="reference external" href="https://aws.amazon.com/iot-sitewise/">https://aws.amazon.com/iot-sitewise/</a>.</p>
</section>
<section id="installation-and-configuration">
<h2>12.2    Installation and Configuration<a class="headerlink" href="#installation-and-configuration" title="Permalink to this headline">¶</a></h2>
<section id="ssb-installation-and-cloud-infrastructure-provisioning">
<h3>12.2.1  SSB installation and cloud infrastructure provisioning<a class="headerlink" href="#ssb-installation-and-cloud-infrastructure-provisioning" title="Permalink to this headline">¶</a></h3>
<p>We need to provision the AWS infrastructure and install SSB in the EC2 instance. Please use below link to carry out SSB installation and cloud infrastructure provisioning procedure -</p>
<blockquote>
<div><p><a class="reference external" href="https://docs.chariot.io/display/CLD80/IBAS%3A+Installation">https://docs.chariot.io/display/CLD80/IBAS%3A+Installation</a></p>
</div></blockquote>
<p>Please note that there are two different delivery methods for SSB installation. Please select ‘CloudFormation Template’ as delivery method.</p>
<p>Once the process is completed, the result will be ‘CREATE_COMPLETE.’</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_1_update.png"><img alt="../_images/image12_1_update.png" src="../_images/image12_1_update.png" style="width: 621.9px; height: 275.40000000000003px;" /></a>
</figure>
</section>
<section id="aws-iot-core-broker-and-ssb-configuration">
<h3>12.2.2  AWS IoT core broker and SSB configuration<a class="headerlink" href="#aws-iot-core-broker-and-ssb-configuration" title="Permalink to this headline">¶</a></h3>
<p>A ‘thing’ needs to be created in AWS IoT core which represent the IoT edge device i.e., UWC gateway. SSB needs to be configured so that it can access IoT core to fetch the UWC gateway data. Please use the link to carry out the complete AWS IoT Core broker and SSB configuration procedure -</p>
<p><a class="reference external" href="https://docs.chariot.io/display/CLD80/SSB%3A+Quickstart">https://docs.chariot.io/display/CLD80/SSB%3A+Quickstart</a>.</p>
<p>Alternate link to get an insight on the creation of a ‘thing’ in AWS IoT core - <a class="reference external" href="https://docs.aws.amazon.com/iot/latest/developerguide/iot-moisture-create-thing.html">https://docs.aws.amazon.com/iot/latest/developerguide/iot-moisture-create-thing.html</a></p>
</section>
<section id="uwc-gateway-configuration">
<h3>12.2.3  UWC gateway configuration<a class="headerlink" href="#uwc-gateway-configuration" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>SSL certificates which were created in STEP <span class="m">2</span> during the creation of a ‘thing’ in AWS IoT core must be inputted <span class="k">while</span> running the ‘01_pre-requisites.sh’ script.

*<span class="nv">$sudo</span> ./02_provision_UWC.sh --deployMode<span class="o">=</span>dev --recipe<span class="o">=</span><span class="m">3</span> --isTLS<span class="o">=</span>yes --caFile<span class="o">=</span><span class="s2">&quot;/&lt;path&gt;/root-ca.crt&quot;</span> --crtFile<span class="o">=</span><span class="s2">&quot;/&lt;path&gt; /client.crt&quot;</span> --keyFile<span class="o">=</span><span class="s2">&quot;/&lt;path&gt; client.key&quot;</span> --brokerAddr<span class="o">=</span><span class="s2">&quot;azeyj7bji4ghe-ats.iot.us-west-2.amazonaws.com&quot;</span> --brokerPort<span class="o">=</span><span class="m">8883</span> --qos<span class="o">=</span><span class="m">1</span>*
</pre></div>
</div>
<p>Deploy Mode ‘dev’ or ‘Prod’.</p>
<p>Select Recipe as 3 to have Sparkplug Container deployed.</p>
<p>Make sure the ‘isTLS’ argument is set to ‘yes’</p>
<p>Configure the ‘caFile’ argument with the path of the CA certificate obtained from AWS IoT core.</p>
<p>Configure the ‘crtFile’ argument with the path of the client certificate obtained from AWS IoT core.</p>
<p>Configure the ‘keyFile’ argument with the path of the client private key obtained from AWS IoT core</p>
<p>‘brokerPort’ should be set to ‘8883.’</p>
<p>‘brokerAddr’ should be set to the custom endpoint of the AWS IoT core. Use the following couple of steps to fetch the custom endpoint.</p>
<p>Go to the IoT core console. Select the ‘Settings’ tab in the left pane.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_2_update.png"><img alt="../_images/image12_2_update.png" src="../_images/image12_2_update.png" style="width: 845.5999999999999px; height: 402.5px;" /></a>
</figure>
<p>Custom endpoint which represents the IoT core broker address. This address needs to be configured in the ‘brokerAddr’ argument as shown in below image.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_3_update.png"><img alt="../_images/image12_3_update.png" src="../_images/image12_3_update.png" style="width: 843.5px; height: 400.4px;" /></a>
</figure>
</section>
</section>
<section id="monitor-data-on-cloud">
<h2>12.3    Monitor Data on Cloud<a class="headerlink" href="#monitor-data-on-cloud" title="Permalink to this headline">¶</a></h2>
<p>The data can be monitored on the AWS Sitewise service.</p>
<p>Scroll to the AWS Sitewise service in the AWS management console as shown in below image</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_4_update.png"><img alt="../_images/image12_4_update.png" src="../_images/image12_4_update.png" style="width: 725.4px; height: 375.0px;" /></a>
</figure>
<p>Go to the ‘Models’ tab. The attribute ‘Protocol’ of a model can be seen.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_5_update.png"><img alt="../_images/image12_5_update.png" src="../_images/image12_5_update.png" style="width: 723.6px; height: 312.59999999999997px;" /></a>
</figure>
<p>The ‘measurement’ parameter representing a data point can be seen in the model.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_6_update.png"><img alt="../_images/image12_6_update.png" src="../_images/image12_6_update.png" style="width: 723.6px; height: 340.2px;" /></a>
</figure>
<p>Navigate to the ‘Assets’ tab. The attribute ‘Protocol’ can be seen with its defined value.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_7_update.png"><img alt="../_images/image12_7_update.png" src="../_images/image12_7_update.png" style="width: 725.4px; height: 360.59999999999997px;" /></a>
</figure>
<p>The ‘measurement’ parameter representing a data point can be seen in the asset with its defined value.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/image12_8_update.png"><img alt="../_images/image12_8_update.png" src="../_images/image12_8_update.png" style="width: 724.8px; height: 354.0px;" /></a>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One should delete old Assets &amp; Models from AWS IoT to ensure the updated Assets and Models get reflected. Duplicate Assets and Models will not be refreshed.</p>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="page_13.html" class="btn btn-neutral float-right" title="13.0 Steps to Apply RT Patch" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="page_11.html" class="btn btn-neutral float-left" title="11.0 Steps to flash LFM BIOS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, APP.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>